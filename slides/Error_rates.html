<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>P values</title>
    <meta charset="utf-8" />
    <meta name="author" content="Philip Leftwich" />
    <meta name="date" content="2023-02-20" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/viz/viz.js"></script>
    <link href="libs/DiagrammeR-styles/styles.css" rel="stylesheet" />
    <script src="libs/grViz-binding/grViz.js"></script>
    <link rel="stylesheet" href="css/my-theme.css" type="text/css" />
    <link rel="stylesheet" href="css/my-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">






class: title-slide, left, top

# P values

## Type 1 &amp; 2 errors

### Philip Leftwich

&lt;br&gt;



&lt;span style='color:white;'&gt;Slides released under&lt;/span&gt; [CC-BY 2.0](https://creativecommons.org/licenses/by/2.0/)&amp;nbsp;&amp;nbsp;<svg aria-hidden="true" role="img" viewBox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:white;overflow:visible;position:relative;"><path d="M245.83 214.87l-33.22 17.28c-9.43-19.58-25.24-19.93-27.46-19.93-22.13 0-33.22 14.61-33.22 43.84 0 23.57 9.21 43.84 33.22 43.84 14.47 0 24.65-7.09 30.57-21.26l30.55 15.5c-6.17 11.51-25.69 38.98-65.1 38.98-22.6 0-73.96-10.32-73.96-77.05 0-58.69 43-77.06 72.63-77.06 30.72-.01 52.7 11.95 65.99 35.86zm143.05 0l-32.78 17.28c-9.5-19.77-25.72-19.93-27.9-19.93-22.14 0-33.22 14.61-33.22 43.84 0 23.55 9.23 43.84 33.22 43.84 14.45 0 24.65-7.09 30.54-21.26l31 15.5c-2.1 3.75-21.39 38.98-65.09 38.98-22.69 0-73.96-9.87-73.96-77.05 0-58.67 42.97-77.06 72.63-77.06 30.71-.01 52.58 11.95 65.56 35.86zM247.56 8.05C104.74 8.05 0 123.11 0 256.05c0 138.49 113.6 248 247.56 248 129.93 0 248.44-100.87 248.44-248 0-137.87-106.62-248-248.44-248zm.87 450.81c-112.54 0-203.7-93.04-203.7-202.81 0-105.42 85.43-203.27 203.72-203.27 112.53 0 202.82 89.46 202.82 203.26-.01 121.69-99.68 202.82-202.84 202.82z"/></svg><svg aria-hidden="true" role="img" viewBox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:white;overflow:visible;position:relative;"><path d="M314.9 194.4v101.4h-28.3v120.5h-77.1V295.9h-28.3V194.4c0-4.4 1.6-8.2 4.6-11.3 3.1-3.1 6.9-4.7 11.3-4.7H299c4.1 0 7.8 1.6 11.1 4.7 3.1 3.2 4.8 6.9 4.8 11.3zm-101.5-63.7c0-23.3 11.5-35 34.5-35s34.5 11.7 34.5 35c0 23-11.5 34.5-34.5 34.5s-34.5-11.5-34.5-34.5zM247.6 8C389.4 8 496 118.1 496 256c0 147.1-118.5 248-248.4 248C113.6 504 0 394.5 0 256 0 123.1 104.7 8 247.6 8zm.8 44.7C130.2 52.7 44.7 150.6 44.7 256c0 109.8 91.2 202.8 203.7 202.8 103.2 0 202.8-81.1 202.8-202.8.1-113.8-90.2-203.3-202.8-203.3z"/></svg> ]

&lt;span style='color:white;'&gt;Slido #4326367&lt;/span&gt;

&lt;div style = "position: absolute;top: 0px;right: 0px;"&gt;&lt;img src="images/logo.png" alt="The hex logo for plumbertableau package" width="500"&gt;&lt;/img&gt;&lt;/div&gt;

---

layout: true

&lt;div class="my-footer"&gt;&lt;span&gt;Philip Leftwich - 5023Y Courses Slido.com #4326367/span&gt;&lt;/div&gt;




---
class: center, middle

### What is a P-value

--

## The probability of getting results at least as extreme as the ones we observed. Assuming the Null Hypothesis is true

---

## Hypothesis formation

--

**Null hypothesis:** there is **no** difference in longevity between the two groups.

--

**Alternative hypothesis:** there *is* a difference in longevity between the two groups.



---

# Null hypothesis probability distribution

&lt;img src="images/null_hypothesis.png" width="60%" /&gt;

These areas represent 2.5% of the values in the left tail of the distribution, and 2.5% of the values in the right tail of the distribution. 

Together, they make up 5% of the most extreme mean differences we would expect to observe, given our number of observations, 

when the true mean difference is exactly 0 – this represents the use of an `\(\alpha\)` level of 5%


---

## Sample size can affect distributions

&lt;img src="images/null_5000.png" width="60%" /&gt;

A probability distribution can be affected by variance and sample size. 


---

## Hypothesis testing

The **null hypothesis** is that there is no relationship between your variables of interest or that there is no difference among groups

e.g you want to know whether there is a difference in longevity between two groups of mice fed on different diets, diet A and diet B. 

--

**Null hypothesis:** there is **no** difference in longevity between the two groups.

--

**Alternative hypothesis:** there *is* a difference in longevity between the two groups.

--


We can use a linear model to perform a t-test on the data


```
lm(longevity ~ diet, data = mice)
```




---

## Visualising the t distribution of the difference


```
## # A tibble: 2 x 7
##   term        estimate std.error statistic  p.value conf.low conf.high
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)     4.19     0.276     15.2  3.87e-13     3.62     4.77 
## 2 dietmice_b     -1.41     0.391     -3.60 1.60e- 3    -2.22    -0.595
```

&lt;img src="Error_rates_files/figure-html/unnamed-chunk-4-1.png" width="50%" /&gt;

---

### Compare these write-ups

“Diets can change the longevity of mice (*p* = 0.0016).”

--

“Mice on diet B lived significantly shorter lives than mice on diet A (*t*&lt;sub&gt;22&lt;/sub&gt; = -3.6, *p* = 0.006).”

--

"Mice on diet B had a reduced mean lifespan of 1.41 years[95% CI; -0.595:-2.22] from the mice on diet A (mean 4.19 years (95% CI, 3.62-4.77). While statistically significant (*t*&lt;sub&gt;22&lt;/sub&gt; = -3.6, *p* = 0.006), this is a relatively small sample size, and further testing is recommended to confirm this effect."

--

Which has the greatest level of useful detail?

---

class: center, middle, inverse

## Common misundertandings\n about P values

https://daniellakens.blogspot.com/2017/12/understanding-common-misconceptions.html?m=1

https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4359000/#:~:text=Evidence%20for%20p%2Dhacking%20from,test%20function%20in%20R).


---

## Comparing hypothetical distributions

In the real world we will never know whether there is a true mean difference, but let's assume that we could. 

The figure below shows the expected data pattern when the null hypothesis is true (grey line) and the expected data pattern when an alternative hypothesis is true (black line). 

&lt;img src="images/null-and-alternate.png" width="60%" /&gt;

---

## A non-significant p-value DOES NOT mean the null hypothesis is true

.pull-left[


Here we can illustrate why a non-significant result does not always mean that the null hypothesis is true.

We *know* that the true mean difference is 0.5, but we only *observe* a mean difference of 0.35.  *p* &gt; `\(\alpha\)`. 

BUT - we can see that the observed mean difference is much more likely under the alternative hypothesis than the null. All the *p*-value tells us is that seeing an observed difference of 0.35 is not that surprising under the null hypothesis.

]

.pull-right[


&lt;img src="images/type-2.png" width="90%" /&gt;

]

---

## Why a significant p-value does not mean the null hypothesis is false


What we can conclude, based on our data, is that we have observed an extreme outcome, that should be considered surprising. But such an outcome is not *impossible* when the null-hypothesis is true.

&lt;img src="images/type-1.png" width="60%" /&gt;

---

## Why a significant p-value is not the same as an important effect

.pull-left[

If we plot the null model for a very large sample size, we can see that even very small mean differences will be considered 'surprising'. 

However, just because data is surprising, does not mean we need to care about it. It is mainly the verbal label ‘significant’ that causes confusion here – it is perhaps less confusing to think of a ‘significant’ effect as a ‘surprising’ effect.

]

.pull-right[

&lt;img src="images/sample-size.png" width="90%" /&gt;

]

---

class: center, middle

## Type 1 and Type 2 Errors:

We have now seen that it is possible to make incorrect decisions about rejecting or keeping the null hypothesis.


|             | H0 True   | H0 False     
| ----------- | ----------- |----------- |
| Reject H0 | Type 1 Error `$$\alpha$$` | Correct rejection `$$1-\beta$$`
| Fail to reject H0    | Correct decision `$$1-\alpha$$` | Type 2 Error  `$$\beta$$`   

---
class: center, middle

&lt;img src="images/type_1_errors.png" title="P &amp;gt; 0.05." alt="P &amp;gt; 0.05." width="60%" /&gt;

Type 1 error = Rejecting the null hypothesis (because *p* &lt; `\(\alpha\)`), but actually this was a random sampling effect, not a *true difference*

---
class: center, middle

&lt;img src="images/type_2_errors.png" title="P &amp;lt; 0.05." alt="P &amp;lt; 0.05." width="60%" /&gt;

Type 2 error = Keeping the null hypothesis (because *p* &gt; `\(\alpha\)`) the random sampling effect made it look like they come from the *same* parent distribution, but in reality the populations are distinct. 

---

## Type 2 error

* Probability of a Type 2 error is known as `\(\beta\)` 

--

* Power is the inverse of a Type 2 error `\(\beta=1-Power\)` 

--

* A Type 2 error is the scenario where you fail to detect a *true* difference/effect

--

* Power is the probability you **will** detect a *true* difference/effect 
    *if the alternative hypothesis is true*

---

## Power

There are four primary factors affecting power:

--

* Effect size: The magnitude of a result present in a population

* Sample size: The number of observations per sample

* Alpha: the threshold at which you would accept statistical significance (often 0.05)

* Power: the probability of accepting the alternate hypothesis (if it is true)

--

Raising the value of any of effect size, sample size or `\(\alpha\)` all increase Power `\(1-\beta\)`


---

## Am I right?

Reporting effect sizes, levels of uncertainty and understanding the statistical power of your experiment are all important. 

--

But a single experiment is **never** enough to know which hypothesis is correct. 

--

Only multiple experiments will allow true statistical trends to emerge

&lt;img src="Error_rates_files/figure-html/figures-side-1.png" width="40%" /&gt;&lt;img src="Error_rates_files/figure-html/figures-side-2.png" width="40%" /&gt;


---

## Are most published results wrong?

class: center, middle

&lt;div class="figure"&gt;
<div id="htmlwidget-53d703b06b97533ea0de" style="width:100%;height:403.2px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-53d703b06b97533ea0de">{"x":{"diagram":"\ndigraph boxes_and_circles {\n  rankdir = LR\n\n  # a \"graph\" statement\n  graph [overlap = true, fontsize = 8]\n\n\n\n\n  # several \"node\" statements\n  node [shape = box,\n        fontname = Helvetica]\n\n  \n# label names\n\nA[label = \"200\n experiments\"]\nB[label = \"20 \n real effect \"]\nC[label = \"180 \n no real effect\"]\n\nF[label = \"171 \n true null \n rejection\"]\nG[label = \"9 \n false null \n rejection\",\ncolor = blue]\n\nE[label = \"4 \n real effect \nnot found\",\n\ncolor = red]\nD[label = \"16 \n real effect \n found\"]\n\n  # several \"edge\" statements\n  A->B \n  A->C\n  C->F[label = 0.95]\n  C->G[label = 0.05]\n  B->D[label = 0.8]\n  B->E[label = 0.2]\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
&lt;p class="caption"&gt;9/(16+9) = 36% of significant p values would be false positives&lt;/p&gt;
&lt;/div&gt;

.pull-left[

[Smaldino &amp; McElreath 2016](https://royalsocietypublishing.org/doi/full/10.1098/rsos.160384?wm=3049_a111)

]


---


## Irreproducible science

* Publication bias

* Low statistical power

* P-hacking

* P-HARKing (*H*ypothesis *A*fter *R*esults *K*nown)

[Bishop 2019](https://www.nature.com/articles/d41586-019-01307-2)


---

## What can be done?

- Open, reproducible analyses can disclose analysis choices and sample sizes

- Pre-registered studies can detect P-hacking and HARKing

---


class: center, middle, inverse

# Next time: Regression

### Reading 

 Chapter 2: Discovering Statistics using R/SPSS - Andy Field

 [20% Statistician (Lakens)](https://daniellakens.blogspot.com/2017/12/understanding-common-misconceptions.html?m=1)
 
 [Pain 2017](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5665734/)




    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "dracula",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
