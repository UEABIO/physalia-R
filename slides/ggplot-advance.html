<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>GGplot</title>
    <meta charset="utf-8" />
    <meta name="author" content="Philip Leftwich" />
    <meta name="date" content="2024-09-18" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="css/my-theme.css" type="text/css" />
    <link rel="stylesheet" href="css/my-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">








class: title-slide, left, top

# GGplot

## Advanced

### Philip Leftwich

&lt;br&gt;



&lt;span style='color:white;'&gt;Slides released under&lt;/span&gt; [CC-BY 2.0](https://creativecommons.org/licenses/by/2.0/)&amp;nbsp;&amp;nbsp;<svg aria-hidden="true" role="img" viewBox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:white;overflow:visible;position:relative;"><path d="M245.83 214.87l-33.22 17.28c-9.43-19.58-25.24-19.93-27.46-19.93-22.13 0-33.22 14.61-33.22 43.84 0 23.57 9.21 43.84 33.22 43.84 14.47 0 24.65-7.09 30.57-21.26l30.55 15.5c-6.17 11.51-25.69 38.98-65.1 38.98-22.6 0-73.96-10.32-73.96-77.05 0-58.69 43-77.06 72.63-77.06 30.72-.01 52.7 11.95 65.99 35.86zm143.05 0l-32.78 17.28c-9.5-19.77-25.72-19.93-27.9-19.93-22.14 0-33.22 14.61-33.22 43.84 0 23.55 9.23 43.84 33.22 43.84 14.45 0 24.65-7.09 30.54-21.26l31 15.5c-2.1 3.75-21.39 38.98-65.09 38.98-22.69 0-73.96-9.87-73.96-77.05 0-58.67 42.97-77.06 72.63-77.06 30.71-.01 52.58 11.95 65.56 35.86zM247.56 8.05C104.74 8.05 0 123.11 0 256.05c0 138.49 113.6 248 247.56 248 129.93 0 248.44-100.87 248.44-248 0-137.87-106.62-248-248.44-248zm.87 450.81c-112.54 0-203.7-93.04-203.7-202.81 0-105.42 85.43-203.27 203.72-203.27 112.53 0 202.82 89.46 202.82 203.26-.01 121.69-99.68 202.82-202.84 202.82z"/></svg><svg aria-hidden="true" role="img" viewBox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:white;overflow:visible;position:relative;"><path d="M314.9 194.4v101.4h-28.3v120.5h-77.1V295.9h-28.3V194.4c0-4.4 1.6-8.2 4.6-11.3 3.1-3.1 6.9-4.7 11.3-4.7H299c4.1 0 7.8 1.6 11.1 4.7 3.1 3.2 4.8 6.9 4.8 11.3zm-101.5-63.7c0-23.3 11.5-35 34.5-35s34.5 11.7 34.5 35c0 23-11.5 34.5-34.5 34.5s-34.5-11.5-34.5-34.5zM247.6 8C389.4 8 496 118.1 496 256c0 147.1-118.5 248-248.4 248C113.6 504 0 394.5 0 256 0 123.1 104.7 8 247.6 8zm.8 44.7C130.2 52.7 44.7 150.6 44.7 256c0 109.8 91.2 202.8 203.7 202.8 103.2 0 202.8-81.1 202.8-202.8.1-113.8-90.2-203.3-202.8-203.3z"/></svg> ]   

&lt;div style = "position: absolute;top: 0px;right: 0px;"&gt;&lt;img src="images/logo.png" alt="The hex logo for plumbertableau package" width="500"&gt;&lt;/img&gt;&lt;/div&gt;



---

# Data visualisation


- Dataset from Danielle Navarro

&lt;!-- *********** NEW SLIDE ************** --&gt;
---



```r
# load data
beaches &lt;- read_csv(here("data","sydneybeaches3.csv")) 

# show data
beaches
```

```
## # A tibble: 344 × 12
##    date        year month   day season rainfall temperature enterococci day_num
##    &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;
##  1 2013-01-02  2013     1     2      1      0          23.4         6.7       2
##  2 2013-01-06  2013     1     6      1      0          30.3         2         6
##  3 2013-01-12  2013     1    12      1      0          31.4        69.1      12
##  4 2013-01-18  2013     1    18      1      0          46.4         9        18
##  5 2013-01-24  2013     1    24      1      0          27.5        33.9      24
##  6 2013-01-30  2013     1    30      1      0.6        26.6        26.5      30
##  7 2013-02-05  2013     2     5      1      0.1        25.7        66.9      36
##  8 2013-02-11  2013     2    11      1      8          22.2       118.       42
##  9 2013-02-17  2013     2    17      1     13.6        26.3        75        48
## 10 2013-02-23  2013     2    23      1      7.2        24.8       311.       54
## # ℹ 334 more rows
## # ℹ 3 more variables: month_num &lt;dbl&gt;, month_name &lt;chr&gt;, season_name &lt;chr&gt;
```



&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

A simple plot


```r
ggplot(
  beaches, 
  aes(temperature, rainfall)
) + 
geom_point()
```

- A little verbose?
- Not the prettiest plot?
- Why is it like this?

]

.right-plot[


&lt;img src="ggplot-advance_files/figure-html/introplot-1.png" width="120%" /&gt;

]




&lt;!-- *********** NEW SLIDE ************** --&gt;
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[

.center[
# ggplot2 is...
]
&lt;br&gt;

## A grammar...

- grammars compose &amp; reuse small parts
- complex structures from simpler units

## ...of graphics

- uses the "painters model"
- a plot is built in layers
- each layer is drawn on top of the last

]]]
]]

.column.bg-main3[.content.vmiddle.center[



]]







&lt;!-- *********** NEW SLIDE ************** --&gt;
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.left-code[

A blank canvas


```r
ggplot()
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/blankcanvas-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---
class: split-50 bg-main1

.left-code[

Specify the data


```r
ggplot(
* data = beaches
)
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/stillblankcanvas-1.png" width="120%" /&gt;

]


---


.left-code[


```r
ggplot(
  data = beaches,
* mapping = aes(
*   x = temperature,
*   y = rainfall
* )
)
```



- .orange[x]-axis location
- .orange[y]-axis location
- .orange[colour] of marker
- .orange[fill] of a marker
- .orange[shape] of a marker, etc.

]

.right-plot[


&lt;img src="ggplot-advance_files/figure-html/aesthetics-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Add a plot .orange[layer]


```r
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
*geom_point()
```

- the .orange[points]
- the .orange[lines]
- the .orange[histograms]
- etc

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/add_layer-1.png" width="120%" /&gt;

]



&lt;!-- *********** NEW SLIDE ************** --&gt;
---


.left-code[

Add layer-specific parameters

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
*geom_point(size = 3)
```

]

.right-plot[


&lt;img src="ggplot-advance_files/figure-html/add_fixedaesthetic-1.png" width="120%" /&gt;

]






&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Add layer-specific mappings

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(
* mapping = aes(colour = season_name),
  size = 3
)   
```

]

.right-plot[


&lt;img src="ggplot-advance_files/figure-html/add_layeraesthetic-1.png" width="120%" /&gt;

]






&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Add more layers to the plot

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(
  mapping = aes(colour = season_name),
  size = 3
) + 
*geom_rug()
```

]

.right-plot[


&lt;img src="ggplot-advance_files/figure-html/two_layers-1.png" width="120%" /&gt;

]



&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Split into .orange[facets]

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(
  mapping = aes(colour = season_name), 
  size = 2
) + 
geom_rug() + 
*facet_wrap(vars(season_name))
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/add_facets-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Remove an unwanted legend?

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(
  mapping = aes(colour = season_name), 
  size = 2,
* show.legend = FALSE
) + 
geom_rug() + 
facet_wrap(vars(season_name)) 
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/remove_legend-1.png" width="120%" /&gt;

]


&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Modify the .orange[theme]

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(
  mapping = aes(colour = season_name), 
  size = 2,
  show.legend = FALSE 
) + 
geom_rug() + 
facet_wrap(vars(season_name)) + 
*theme_bw()
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/add_theme-1.png" width="120%" /&gt;

]







&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[


```r
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall)) + 
geom_point(
  mapping = aes(colour = season_name), 
  size = 2,
  show.legend = FALSE) +  
geom_rug() + 
facet_wrap(vars(season_name)) + 
theme_bw() +
*labs(
* title = "Sydney weather by season",
* subtitle = "Data from 2013 to 2018",
* x = "Temperature (Celsius)",
* y = "Rainfall (mm)"
*) 
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/add_titles-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
All the ingredients are needed!

- Data
- Aesthetics
- Layers
- Facets
- Theme
- (Coordinates)
- (Scales)

]]]
]]

--

.column.bg-main3[.content.vtop.center[
.pull.left[.pad1[.font2[
So when I type this...

```r
ggplot(
  beaches, 
  aes(temperature, rainfall)
) + 
geom_point()
```

]]]
]]




&lt;!-- *********** NEW SLIDE ************** --&gt;
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
All the ingredients are needed!

- Data
- Aesthetics
- Layers
- Facets
- Theme
- (Coordinates)
- (Scales)

]]]
]]

.column.bg-main3[.content.vtop.center[
.pull.left[.pad1[.font2[
What I get is this...

```r
ggplot(
  data = beaches, 
  mapping = aes(
    x = temperature, y = rainfall)) + 
layer(
  geom = "point",
  stat = "identity",
  position = "identity") + 
facet_null() +
theme_grey() + 
coord_cartesian() + 
scale_x_continuous() + 
scale_y_continuous()
```

]]]
]]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---


# Aesthetics





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[


```r
ggplot(
  data = beaches,
  mapping = aes(
*   x = date,
*   y = log10(enterococci)
  ) 
) + 
geom_line()
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-14-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

The .orange[colour] can be an aesthetic

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = date,
    y = log10(enterococci),
*   colour = season_name
  ) 
) + 
geom_line()
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-16-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

The .orange[group] aesthetic matters!


```r
ggplot(
  data = beaches,
  mapping = aes(
    x = date,
    y = log10(enterococci),
    colour = season_name,
*   group = 1,
  ) 
) + 
geom_line()
```

]

.right-plot[


&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-18-1.png" width="120%" /&gt;

]






&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[


The .orange[group] aesthetic matters!

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = date,
    y = log10(enterococci),
    colour = season_name,
*   group = month,
  ) 
) + 
geom_line()
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-20-1.png" width="120%" /&gt;

]

&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

The .orange[fill] can be an aesthetic

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = log10(enterococci),
*   fill = season_name
  ) 
) + 
*geom_histogram()
```

]

.right-plot[


&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-22-1.png" width="120%" /&gt;

]



&lt;!-- *********** NEW SLIDE ************** --&gt;
---


# Geoms



&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Points and lines are "simple" geoms

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = date,
    y = log10(enterococci)
  ) 
) + 
*geom_line()
```

]

.right-plot[


&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-24-1.png" width="120%" /&gt;

]



&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Points and lines are "simple" geoms

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = date,
    y = log10(enterococci)
  ) 
) + 
*geom_point()
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-26-1.png" width="120%" /&gt;

]




&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Geoms can be layered and take parameters

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = date,
    y = log10(enterococci)
  ) 
) + 
*geom_point(size = 5) +
*geom_line(colour = "red")
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-28-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

The order of geoms matters

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = date,
    y = log10(enterococci)
  ) 
) + 
*geom_line(colour = "red") +
*geom_point(size = 5)
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-30-1.png" width="120%" /&gt;

]


&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Geoms can have different mappings

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = date,
    y = log10(enterococci)) ) + 
geom_line(
  linewidth = 2, 
* colour = "black") +
geom_point(
* mapping = aes(colour = season_name),
  size = 5) 
```

- Must be consistent
- Cannot map .orange[x] to two variables

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-32-1.png" width="120%" /&gt;

]



&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Geoms come in many varieties...

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = season_name,
    y = log10(enterococci))
  ) + 
*geom_boxplot()
```


]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-34-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Geoms come in many varieties...

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = season_name,
    y = log10(enterococci))
  ) + 
*geom_violin()
```


]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-36-1.png" width="120%" /&gt;

]



&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Geoms come in many varieties...

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = date,
    y = log10(enterococci))
  ) + 
*geom_bin2d()
```


]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-38-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---
.left-code[

Geoms come in many varieties...

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = date,
    y = log10(enterococci))
  ) + 
*geom_hex()
```


]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-40-1.png" width="120%" /&gt;

]



&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Geoms come in many varieties...

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = date,
    y = log10(enterococci))
  ) + 
*geom_density_2d()
```


]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-42-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Geoms come in many varieties...

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = date,
    y = log10(enterococci))
  ) + 
geom_point() +
*geom_smooth()
```


]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-44-1.png" width="120%" /&gt;

]




&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Geoms come in many varieties...

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = date,
    y = log10(enterococci))
  ) + 
geom_point() +
*geom_smooth(method = "lm")
```


]

.right-plot[


&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-46-1.png" width="120%" /&gt;

]


&lt;!-- *********** NEW SLIDE ************** --&gt;
---


# How are layers structured?


&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Let's create a plot with no layers!

```r
p &lt;- ggplot(
  data = beaches,
  mapping = aes(x = temperature)) + 
facet_wrap(vars(season_name)) + 
labs( 
  title = "Sydney temperature, 2013-2018", 
  x = "Temperature (Celsius)", y = "") 

print(p)
```

- The partial plot is stored
- Can add to it as needed
- Useful for programming

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-48-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Layers can compute things!

```r
p + geom_histogram() 
```

- histograms are not "in the data"
- this is computed by the layer...
- (...sort of)

]


.right-plot[

&lt;img src="ggplot-advance_files/figure-html/add_histogram-1.png" width="120%" /&gt;

]



&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Layers can compute things!

```r
p1 &lt;- p + geom_histogram() 
p2 &lt;- p + geom_density() 
p2
```


]


.right-plot[

&lt;img src="ggplot-advance_files/figure-html/add_density-1.png" width="120%" /&gt;

]






&lt;!-- *********** NEW SLIDE ************** --&gt;

---

.pull-right[

The layer information... density

```r
p2$layers
```

```
## [[1]]
## geom_density: na.rm = FALSE, orientation = NA, outline.type = upper
## stat_density: na.rm = FALSE, orientation = NA
## position_identity
```

Each layer specifies:
- A .orange[geom]: the graphical object to be drawn
- A .orange[stat]: what "statistic" it is applied to
- A .orange[position]: how it is placed

]

--

.pull-left[

The layer information... histogram

```r
p1$layers
```

```
## [[1]]
## geom_bar: na.rm = FALSE, orientation = NA
## stat_bin: binwidth = NULL, bins = NULL, na.rm = FALSE, orientation = NA, pad = FALSE
## position_stack
```

&lt;br&gt;
- There is hidden complexity!
- Let's dig into this...


]




&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Our histogram...

```r
p + geom_histogram(
  stat = "bin",
  position = "stack"
) 
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-54-1.png" width="120%" /&gt;

]




&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Our histogram...

```r
p + stat_bin(
  geom = "bar",
  position = "stack"
) 
```

- It is the same?!
- It is, but don't do this!
- Use geom to make layers
- Use stat to change computation

]


.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-56-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Reverse engineering...

```r
p + geom_histogram()
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-58-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Reverse engineering...

```r
p + geom_bar(
  stat = "bin", 
  position = "stack"
) 
```

]


.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-60-1.png" width="120%" /&gt;

]








&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[


Making a "dot histogram"

```r
p + geom_point(
  stat = "bin", 
  position = "stack" 
) 
```

]

.right-plot[


&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-62-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---


## [Why are you like this?](https:/cran.r-project.org/web/packages/ggplot2/vignettes/extending-ggplot2.html)

"Unfortunately, due to an early design mistake I called these either stat\_() or geom\_(). A better decision would have been to call them layer\_() functions: that’s a more accurate description because every layer involves a stat and a geom."





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

# Positioning



&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

This is not so helpful!

```r
f &lt;- ggplot(
  data = beaches,
  mapping = aes(
    x = temperature,
    fill = season_name)
  ) 

f + geom_density()
```

]


.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-64-1.png" width="120%" /&gt;

]






&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Let's be clearer...

```r
f + geom_density(
  position = "identity",
  alpha = .5
)
```

- Geom: density
- Stat: density
- Position: .orange[identity]

]


.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-66-1.png" width="120%" /&gt;

]




&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Let's be clearer...

```r
f + geom_density(
* position = "stack",
  alpha = .5
)
```

- Geom: density
- Stat: density
- Position: .orange[stack]

]


.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-68-1.png" width="120%" /&gt;

]







&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Let's be clearer...

```r
f + geom_density(
* position = "fill",
  alpha = .5
)
```

- Geom: density
- Stat: density
- Position: .orange[fill]

]


.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-70-1.png" width="120%" /&gt;

]

---

## ggridges

.left-code[

Let's be clearer...

```r
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature,
*   y = season_name)
  )  +
  ggridges::geom_density_ridges()
```

- Geom: density
- Stat: density
- Position: .orange[fill]

]


.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-72-1.png" width="120%" /&gt;

]


&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

This is not so helpful!

```r
g &lt;- ggplot(
  data = beaches,
  mapping = aes(
    x = year,
    y = temperature)
  ) 

g + geom_point()
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-74-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Let's be clearer...

```r
g + geom_point(
  position = "identity",
  alpha = .5,
  size = 3
)
```

- Geom: point
- Stat: identity
- Position: .orange[identity]

]

.right-plot[


&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-76-1.png" width="120%" /&gt;

]






&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Let's be clearer...

```r
g + geom_point(
  position = "jitter",
  alpha = .5,
  size = 3
)
```

- Geom: point
- Stat: identity
- Position: .orange[jitter]

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-78-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Let's be clearer...

```r
g + geom_point(
* position = position_jitter(
*   width = .1, height = 0),
  alpha = .5,
  size = 3
)
```

- Geom: point
- Stat: identity
- Position: .orange[jitter]

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-80-1.png" width="120%" /&gt;

]






&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

In fact...

```r
*g + geom_jitter(
* width = .1,
* height = 0,
  alpha = .5,
  size = 3
)
```

- Geom: point
- Stat: identity
- Position: .orange[jitter]

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-82-1.png" width="120%" /&gt;

]



---

## Beeswarm

.left-code[


```r
g +
    geom_violin(
    aes(group = year)
  )+
  ggbeeswarm::geom_beeswarm(size = .8)
```

]

.right-plot[


&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-84-1.png" width="120%" /&gt;

]



&lt;!-- *********** NEW SLIDE ************** --&gt;
---


# Facetting



&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

A cluttered density plot...

```r
a &lt;- ggplot(
  data = beaches,
  mapping = aes(
    x = log10(enterococci),
    fill = season_name )
) + geom_density(
  show.legend = FALSE)

print(a)
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-86-1.png" width="120%" /&gt;

]






&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Facetting on a grid...

```r
a + facet_grid(
  rows = vars(season_name)
)
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-88-1.png" width="120%" /&gt;

]








&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Facetting on a grid...

```r
a + facet_grid(
  cols = vars(season_name)
)
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-90-1.png" width="120%" /&gt;

]




&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Facetting on a grid...

```r
a + facet_grid(
  rows = vars(season_name),
  cols = vars(year)
)
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-92-1.png" width="120%" /&gt;

]




&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Facetting by wrapping...

```r
a + facet_wrap(
  facets = vars(season_name), 
  nrow = 2)
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-94-1.png" width="120%" /&gt;

]



&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Facetting by wrapping...

```r
a + facet_wrap(
  facets = vars(year, season_name)
)
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-96-1.png" width="120%" /&gt;

]

&lt;!-- *********** NEW SLIDE ************** --&gt;

---

## ggh4x


.left-code[

Facetting by wrapping...

```r
a + 
  ggh4x::facet_nested(~year + season_name)
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-98-1.png" width="120%" /&gt;

]
---


# Scales 





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

A badly scaled plot...

```r
r &lt;- ggplot(
  data = beaches,
  mapping = aes(
    x = temperature,
    y = enterococci,
    colour = season_name,
    group = 1)) +
  geom_point()

print(r)
```

]


.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-100-1.png" width="120%" /&gt;

]


&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Better!

```r
r + scale_y_continuous(
  name = "Enterococci (cfu/100ml)",
  trans = "log10"
)
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-102-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Better!

```r
r + scale_y_continuous(
  name = "Enterococci (cfu/100ml)",
  trans = "log10",
  labels = scales::number_format(
    digits = 3)
)
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-104-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Even better!

```r
r + scale_y_continuous(
  name = "Enterococci (cfu/100ml)",
  trans = "log10",
  labels = scales::number_format(
    digits = 3)
  ) + 
  scale_x_continuous(
    name = "Temperature",
    labels = scales::unit_format(
      suffix = "°C")
  )
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-106-1.png" width="120%" /&gt;

]


&lt;!-- *********** NEW SLIDE ************** --&gt;
---

# Scales (colour/fill)




&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Now where were we...

```r
b
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-108-1.png" width="120%" /&gt;

]




&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Colour/fill aesthetics have scales

```r
b + scale_colour_discrete(
  name = "Season"
)
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-110-1.png" width="120%" /&gt;

]



&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Many packages provide scales/palettes

```r
b + scico::scale_colour_scico_d(
  name = "Season",
  palette = "lajolla"
)
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-112-1.png" width="120%" /&gt;

]



&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Many packages provide scales/palettes

```r
b + scico::scale_colour_scico_d(
  name = "Season",
  palette = "bilbao"
)
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-114-1.png" width="120%" /&gt;


]


&lt;!-- *********** NEW SLIDE ************** --&gt;
--- 

---


.left-code[

Many packages provide scales/palettes

```r
b + scale_color_manual(values=c("#999999", 
                                "#E69F00", 
                                "#56B4E9",
                                "purple"))
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-116-1.png" width="120%" /&gt;

]


&lt;!-- *********** NEW SLIDE ************** --&gt;
---


# Coordinates




&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

(Some preprocessing...)

```r
rain &lt;- beaches %&gt;% 
  group_by(
    month, year, season_name
    ) %&gt;%
  summarise(
    rain = mean(rainfall)
  ) %&gt;%
  ungroup() %&gt;%
  pivot_wider(
    names_from = year, 
    values_from = rain
  )
```

]


.right-plot[


```
## # A tibble: 12 × 8
##    month season_name `2013` `2014` `2015` `2016` `2017`  `2018`
##    &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
##  1     1 Summer        0.1   0.933   4.6   12.1   2.08   4.24  
##  2     2 Summer        7.22  6.6     2.6    9.24  6.42   0.16  
##  3     3 Autumn        5.72  4.53    5.75  12.3   7.62   3.4   
##  4     4 Autumn        4.08  2.4     4.2    6.16 11.7    0.4   
##  5     5 Autumn        1.97  0.12    2.22   0.05  0.317  0.0167
##  6     6 Winter       23.3   2.85    2.96   4.27 11.5    4.04  
##  7     7 Winter        0     0       3.23   8.68  0      0.02  
##  8     8 Winter        2.08  5.43   12.4    0.2   1.56   0.633 
##  9     9 Spring        0.36 NA       6.32   2.3   0.3    0.08  
## 10    10 Spring        9.2   1.5     1.12   1.3   4.97  18     
## 11    11 Spring       NA     1.5     3.32   2.28  0.12  NA     
## 12    12 Summer        0     5.05   17.6    6.72  0     NA
```

]



&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

A simple scatterplot

```r
ggplot(
  data = rain,
  mapping = aes(
    x = `2013`,
    y = `2017`,
    colour = season_name
  )
) + 
geom_point(size = 5) 
```

]


.right-plot[


&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-120-1.png" width="120%" /&gt;

]




&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

A simple scatterplot

```r
ggplot(
  data = rain,
  mapping = aes(
    x = `2013`,
    y = `2017`,
    colour = season_name
  )
) + 
geom_point(size = 5) + 
*geom_abline(
* slope = 1,
* intercept = 0
*) 
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-122-1.png" width="120%" /&gt;

]



&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

A simple scatterplot

```r
ggplot(
  data = rain,
  mapping = aes(
    x = `2013`,
    y = `2017`,
    colour = season_name
  )
) + 
geom_point(size = 5) + 
geom_abline( 
  slope = 1, 
  intercept = 0 
) + 
*coord_cartesian(
  xlim = c(0, 25), 
  ylim = c(0, 25) 
)
```

]


.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-124-1.png" width="120%" /&gt;

]




---



# Themes



&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Here's one from earlier...

```r
th &lt;- b + 
  scico::scale_colour_scico_d(
    name = "Season",
    palette = "lajolla")

th
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-126-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

The default theme

```r
th + theme_grey()
```

]


.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-128-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Other global themes

```r
th + theme_bw()
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-130-1.png" width="120%" /&gt;

]



&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Other global themes

```r
th + theme_void()
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-132-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Customising a theme

```r
th + theme(
  plot.background = element_rect(
    fill = "#BA68C8", 
    colour = "#BA68C8"
  ) 
)
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-134-1.png" width="120%" /&gt;

]




&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Customising a theme

```r
u &lt;- th + theme(
  plot.background = element_rect(
    fill = "#BA68C8", 
    colour = "#BA68C8"), 
  panel.background = element_rect(
    fill = "#562457",
    colour = "#562457")
)
u
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-136-1.png" width="120%" /&gt;

]


&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Customising a theme

```r
u &lt;- u + theme(
 legend.background = element_rect(
    fill = "#BA68C8", 
    colour = "#BA68C8"))
u
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-138-1.png" width="120%" /&gt;

]





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Customising a theme

```r
u &lt;- u + theme(
  text = element_text(
    colour = "white",
    size = 18
  ))
u
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-140-1.png" width="120%" /&gt;

]



&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

Customising a theme

```r
u &lt;- u + theme(
  axis.text = element_text(
    colour = "white",
    size = 18
  ))
u
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-142-1.png" width="120%" /&gt;

]




&lt;!-- *********** NEW SLIDE ************** --&gt;
---



Custom theme


```r
# custom theme sets defaults for font and size, but these can be changed without changing the function
theme_custom &lt;- function(base_size=12, base_family="serif"){
  theme_classic(base_size = base_size, 
                base_family = base_family,
                )  %+replace%
# update theme minimal 
theme(
  # specify default settings for plot titles - use rel to set titles relative to base size
  plot.title=element_text(size=rel(1.5),
      face="bold",
      family=base_family),
  #specify defaults for axis titles
  axis.title=element_text(
    size=rel(1),
    family=base_family),
  # specify position for y axis title
  axis.title.y=element_text(angle = 90,
                            margin = margin(r = 10, l= 10)),
  # specify position for x axis title
  axis.title.x = element_text(margin = margin(t = 10, b = 10)),
  # set major y grid lines
  panel.grid.major.y = element_line(colour="gray", size=0.5),
  # add axis lines
  axis.line=element_line(),
   # Adding a 0.5cm margin around the plot
  plot.margin = unit(c(0.2, 0.5, 0.5, 0.5), units = , "cm"),    
   # Setting the position for the legend
  legend.position = "none"             
)
  
}
```





&lt;!-- *********** NEW SLIDE ************** --&gt;
---

.left-code[

And so...

```r
th + theme_custom()
```

]

.right-plot[

&lt;img src="ggplot-advance_files/figure-html/unnamed-chunk-145-1.png" width="120%" /&gt;

]















    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "dracula",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
